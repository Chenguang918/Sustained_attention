% Script generated by Brainstorm (12-May-2022)
%  (31-May-2022)
% Preprocess and Loop on subjects 
clear
Subject = [2:50];

for iSubject = 1:length(Subject)
SubjectNames = {['sub',num2str(Subject(iSubject))]};
RawFiles = {['E:\Sustained attention\Baseline\Data\Eyelink\sub',num2str(Subject(iSubject)),'_1.edf']}; 
% Input files
sFiles = [];

% Start a new report
bst_report('Start', sFiles);

% Process: Import MEG/EEG: Existing epochs
sFiles = bst_process('CallProcess', 'process_import_data_epoch', sFiles, [], ...
    'subjectname',   SubjectNames{1}, ...
    'condition',     'Eyelink', ...
    'datafile',      {{RawFiles{1}}, 'EYELINK'}, ...
    'iepochs',       [], ...
    'eventtypes',    '', ...
    'createcond',    0, ...
    'channelalign',  0, ...
    'usectfcomp',    0, ...
    'usessp',        0, ...
    'freq',          [], ...
    'baseline',      [], ...
    'blsensortypes', 'MEG, EEG');

% Save and display report
ReportFile = bst_report('Save', sFiles);
bst_report('Open', ReportFile);
% bst_report('Export', ReportFile, ExportDir);
% bst_report('Email', ReportFile, username, to, subject, isFullReport);
end
