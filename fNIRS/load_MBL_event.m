% Script generated by Brainstorm (12-May-2022)

Subject = [1:50];
for iSubject = 1:length(Subject)
    for iprobe = 1:2
clearvars -except iprobe iSubject Subject   
        
SubjectNames = {['sub',num2str(Subject(iSubject))]};
% Input files
sFiles = [];

RawFiles = strcat('E:\Sustained attention\Baseline\Data\fNIRs\nirsData\',SubjectNames,'_MES_Probe',num2str(iprobe),'.nirs');

% Start a new report
bst_report('Start', sFiles);

% Process: Create link to raw file
sFiles = bst_process('CallProcess', 'process_import_data_raw', sFiles, [], ...
    'subjectname',    SubjectNames{1}, ...
    'datafile',       {RawFiles{1}, 'NIRS-BRS'}, ...
    'channelreplace', 0, ...
    'channelalign',   0, ...
    'evtmode',        'value');

% Process: MBLL - raw to delta [HbO], [HbR] & [HbT]: 
sFiles = bst_process('CallProcess', 'process_nst_mbll', sFiles, [], ...
    'option_age',             25, ...
    'option_pvf',             50, ...
    'option_do_plp_corr',     1, ...
    'option_dpf_method',      2, ...  % DUNCAN1996
    'option_baseline_method', 1, ...  % mean
    'timewindow',             []);

% Process: Detect: 1
sFiles = bst_process('CallProcess', 'process_evt_detect_threshold', sFiles, [], ...
    'eventname',    '1', ...
    'channelname',  'AUX1', ...
    'timewindow',   [], ...
    'blanking',     0.02, ...
    'thresholdMAX', 0.5, ...
    'units',        1, ...  % None: 100
    'bandpass',     [], ...
    'isAbsolute',   0, ...
    'isDCremove',   0);

% Process: Detect: 2
sFiles = bst_process('CallProcess', 'process_evt_detect_threshold', sFiles, [], ...
    'eventname',    '2', ...
    'channelname',  'AUX2', ...
    'timewindow',   [], ...
    'blanking',     0.02, ...
    'thresholdMAX', 0.5, ...
    'units',        1, ...  % None: 100
    'bandpass',     [], ...
    'isAbsolute',   0, ...
    'isDCremove',   0);

% Process: Detect: 3
sFiles = bst_process('CallProcess', 'process_evt_detect_threshold', sFiles, [], ...
    'eventname',    '3', ...
    'channelname',  'AUX2', ...
    'timewindow',   [], ...
    'blanking',     0.02, ...
    'thresholdMAX', 0.5, ...
    'units',        1, ...  % None: 100
    'bandpass',     [], ...
    'isAbsolute',   0, ...
    'isDCremove',   0);

% Process: Detect: 4
sFiles = bst_process('CallProcess', 'process_evt_detect_threshold', sFiles, [], ...
    'eventname',    '4', ...
    'channelname',  'AUX2', ...
    'timewindow',   [], ...
    'blanking',     0.02, ...
    'thresholdMAX', 0.5, ...
    'units',        1, ...  % None: 100
    'bandpass',     [], ...
    'isAbsolute',   0, ...
    'isDCremove',   0);

% Process: Detect: 5
sFiles = bst_process('CallProcess', 'process_evt_detect_threshold', sFiles, [], ...
    'eventname',    '5', ...
    'channelname',  'AUX2', ...
    'timewindow',   [], ...
    'blanking',     0.02, ...
    'thresholdMAX', 0.5, ...
    'units',        1, ...  % None: 100
    'bandpass',     [], ...
    'isAbsolute',   0, ...
    'isDCremove',   0);

% Process: Detect: 6
sFiles = bst_process('CallProcess', 'process_evt_detect_threshold', sFiles, [], ...
    'eventname',    '6', ...
    'channelname',  'AUX2', ...
    'timewindow',   [], ...
    'blanking',     0.02, ...
    'thresholdMAX', 0.5, ...
    'units',        1, ...  % None: 100
    'bandpass',     [], ...
    'isAbsolute',   0, ...
    'isDCremove',   0);

% Process: Detect: 7
sFiles = bst_process('CallProcess', 'process_evt_detect_threshold', sFiles, [], ...
    'eventname',    '7', ...
    'channelname',  'AUX2', ...
    'timewindow',   [], ...
    'blanking',     0.02, ...
    'thresholdMAX', 0.5, ...
    'units',        1, ...  % None: 100
    'bandpass',     [], ...
    'isAbsolute',   0, ...
    'isDCremove',   0);

% Save and display report
ReportFile = bst_report('Save', sFiles);
bst_report('Open', ReportFile);
% bst_report('Export', ReportFile, ExportDir);
% bst_report('Email', ReportFile, username, to, subject, isFullReport);

    end
end